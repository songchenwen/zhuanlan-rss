branches:
  only:
    - master
language: node_js
node_js:
  - "0.10"
script:
  - "node index.js"
after_success:
  - "mkdir -p git_deploy"
  - "cd git_deploy"
  - "rm -rf ./*"
  - "git clone --depth=2 --branch=gh-pages https://$GH_TOKEN@github.com/songchenwen/zhuanlan-rss.git ."
  - "rm -rf ./*"
  - "cp -r ../out/* ./"
  - "git config --global push.default simple"
  - "git config --global user.name 'songchenwen'"
  - "git config --global user.email emptyzone.0@gmail.com"
  - "git diff --exit-code update.log || (git add -A && git commit -m 'update' && git push)"
env:
  global:
    secure: mJQwiECT8BydJer3bCUEsfKfo4Ibsogtm6oxmhN7Ay+aAqaq/N6ne4b3fdw0O0JrU/fNphBBaYzVxkRRK92F2KdjI6LpvMD/Z90iOtQoqDC/6grcttGVvi7oOeax500nFp8Id/GmexRKUMsLunNFrgmvUD2M1R/7cFWHm+uEn7s=
